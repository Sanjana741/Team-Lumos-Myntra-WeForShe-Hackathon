<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myntra - FitHub Community</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* All the CSS styles remain exactly the same */
        /* ... (all CSS code) ... */
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <img src="https://images.indianexpress.com/2021/01/myntra.png" alt="Myntra" class="logo">
                
                <div class="nav-links">
                    <a href="#">MEN</a>
                    <a href="#">WOMEN</a>
                    <a href="#">KIDS</a>
                    <a href="#">HOME & LIVING</a>
                    <a href="#">BEAUTY</a>
                    <a href="#">
                        STUDIO<span class="new-badge">NEW</span>
                    </a>
                    <a href="#" class="active">
                        CONNECT<span class="new-badge">NEW</span>
                    </a>
                </div>
                
                <div class="header-actions">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search for products, brands and more">
                    </div>
                    
                    <div class="profile-container">
                        <i class="far fa-user action-icon"></i>
                        <div class="profile-menu">
                            <a href="#">Profile</a>
                            <a href="#">Orders</a>
                            <a href="#">Wishlist</a>
                            <a href="#" id="rewardPointsLink">Rewards: <span id="headerRewardPoints">45</span> Points</a>
                            <a href="#">Logout</a>
                        </div>
                    </div>
                    
                    <i class="far fa-heart action-icon"></i>
                    <i class="fas fa-shopping-bag action-icon"></i>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <div class="container">
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">MY COMMUNITIES</h3>
                    <ul class="community-list">
                        <li class="community-item active" data-community="petite">
                            <div class="community-item-content">
                                <div class="community-icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <span>Petite Fashion</span>
                            </div>
                            <div class="community-dropdown">
                                <div class="dropdown-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="dropdown-menu">
                                    <div class="dropdown-item active" data-type="posts">
                                        <i class="fas fa-image"></i> Posts
                                    </div>
                                    <div class="dropdown-item" data-type="discussions">
                                        <i class="fas fa-comments"></i> Discussions
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="community-item" data-community="tall">
                            <div class="community-item-content">
                                <div class="community-icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <span>Tall & Slim</span>
                            </div>
                            <div class="community-dropdown">
                                <div class="dropdown-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="dropdown-menu">
                                    <div class="dropdown-item active" data-type="posts">
                                        <i class="fas fa-image"></i> Posts
                                    </div>
                                    <div class="dropdown-item" data-type="discussions">
                                        <i class="fas fa-comments"></i> Discussions
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="community-item" data-community="curvy">
                            <div class="community-item-content">
                                <div class="community-icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <span>Curvy Fashion</span>
                            </div>
                            <div class="community-dropdown">
                                <div class="dropdown-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="dropdown-menu">
                                    <div class="dropdown-item active" data-type="posts">
                                        <i class="fas fa-image"></i> Posts
                                    </div>
                                    <div class="dropdown-item" data-type="discussions">
                                        <i class="fas fa-comments"></i> Discussions
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="community-item" data-community="athletic">
                            <div class="community-item-content">
                                <div class="community-icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <span>Athletic Build</span>
                            </div>
                            <div class="community-dropdown">
                                <div class="dropdown-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="dropdown-menu">
                                    <div class="dropdown-item active" data-type="posts">
                                        <i class="fas fa-image"></i> Posts
                                    </div>
                                    <div class="dropdown-item" data-type="discussions">
                                        <i class="fas fa-comments"></i> Discussions
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                
                <div class="sidebar-section">
                    <h3 class="sidebar-title">REWARD STATUS</h3>
                    <div class="body-stat">
                        <div class="body-stat-value"><span id="rewardPoints">86</span> Points</div>
                        <div class="body-stat-label">Available for discount</div>
                    </div>
                    <p style="font-size: 12px; margin-top: 10px; color: #94969f;">
                        <i class="fas fa-info-circle"></i> Share photos to earn 2 points, videos for 4 points
                    </p>
                </div>
            </div>
            
            <!-- Content Area -->
            <div class="content-area">
                <!-- Profile Section -->
                <div class="profile-section">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-details">
                            <h2>Riya Sharma <span class="verified-badge">VERIFIED</span></h2>
                            <p>Member of Petite Fashion community</p>
                            <div class="profile-stats">
                                <div class="stat-item">
                                    <div class="stat-value" id="postCount">12</div>
                                    <div class="stat-label">Posts</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value"><span id="profileRewardPoints">86</span></div>
                                    <div class="stat-label">Reward Points</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value"><span id="profileUpvotes">124</span></div>
                                    <div class="stat-label">Upvotes</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="sidebar-title">MY BODY PROFILE</h3>
                    <div class="body-stats">
                        <div class="body-stat">
                            <div class="body-stat-value">5'2"</div>
                            <div class="body-stat-label">Height</div>
                        </div>
                        <div class="body-stat">
                            <div class="body-stat-value">32-28-34</div>
                            <div class="body-stat-label">Measurements</div>
                        </div>
                        <div class="body-stat">
                            <div class="body-stat-value">Petite</div>
                            <div class="body-stat-label">Body Type</div>
                        </div>
                    </div>
                </div>
                
                <!-- Content Header -->
                <div class="content-header">
                    <h2 class="section-title">Recent Posts in Petite Fashion</h2>
                    
                    <div class="view-toggle">
                        <div class="view-option active" data-view="posts">
                            <i class="fas fa-th"></i> Posts
                        </div>
                        <div class="view-option" data-view="discussions">
                            <i class="fas fa-comments"></i> Discussions
                        </div>
                    </div>
                    
                    <div class="create-buttons">
                        <button class="create-post-btn" id="createPostBtn">
                            <i class="fas fa-plus"></i> Create Post
                        </button>
                        <button class="create-discussion-btn" id="createDiscussionBtn" style="display: none;">
                            <i class="fas fa-plus"></i> Create Discussion
                        </button>
                    </div>
                </div>
                
                <!-- Posts View -->
                <div class="posts-view" id="postsView">
                    <div class="posts-grid" id="postsContainer">
                        <!-- Content will be loaded dynamically based on community -->
                    </div>
                </div>
                
                <!-- Discussions View -->
                <div class="discussions-view" id="discussionsView" style="display: none;">
                    <div class="discussions-list" id="discussionsContainer">
                        <!-- Content will be loaded dynamically based on community -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Create Post Modal -->
    <div class="modal" id="createPostModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Post</h3>
                <span class="close-modal">&times;</span>
            </div>
            
            <div class="media-type-selector">
                <div class="media-type-btn active" data-type="photo">
                    <i class="fas fa-camera"></i> Photo (2 points)
                </div>
                <div class="media-type-btn" data-type="video">
                    <i class="fas fa-video"></i> Video (4 points)
                </div>
            </div>
            
            <div class="reward-notice">
                <i class="fas fa-gift"></i> You'll earn <span id="rewardAmount">2</span> reward points for this post!
            </div>
            
            <div class="upload-area" id="uploadArea">
                <i class="fas fa-cloud-upload-alt"></i>
                <p class="upload-text">Click to upload a <span id="mediaTypeText">photo</span></p>
                <input type="file" id="mediaUpload" accept="image/*" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
            </div>
            
            <div id="imagePreview" class="upload-preview"></div>
            
            <div class="post-form">
                <textarea id="postCaption" placeholder="Describe how this product fits your body type..."></textarea>
                <button type="button" id="submitPostBtn" disabled>
                    Share Post
                    <div class="spinner" id="submitSpinner"></div>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Create Discussion Modal -->
    <div class="modal" id="createDiscussionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Start a Discussion</h3>
                <span class="close-modal">&times;</span>
            </div>
            
            <div class="discussion-form">
                <input type="text" id="discussionTitle" placeholder="Enter discussion title">
                <textarea id="discussionContent" placeholder="What would you like to discuss?"></textarea>
                <button type="button" id="submitDiscussionBtn">
                    Start Discussion
                    <div class="spinner" id="submitDiscussionSpinner"></div>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">Post created successfully! +2 points earned.</span>
    </div>

    <script>
        // State management
        let rewardPoints = 86;
        let upvotes = 124;
        let postCount = 12; // Added post count variable
        let mediaType = 'photo';
        let uploadedMedia = null;
        let currentView = 'posts';
        let currentCommunity = 'petite';
        let currentContentType = 'posts'; // 'posts' or 'discussions'
        
        // Track which posts belong to the current user
        const userPosts = new Set();
        
        // Community content data
        const communityContent = {
            petite: {
                posts: [
                    {
                        image: "https://images.unsplash.com/photo-1567401893414-76b7b1e5a7a5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Priya M.",
                        content: "This dress fits perfectly for my petite frame! The length is just right.",
                        likes: 42,
                        comments: 8,
                        points: 2
                    },
                    {
                        image: "https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Neha K.",
                        content: "Sharing how this jumpsuit fits my 5'1\" frame. Perfect for casual outings!",
                        likes: 67,
                        comments: 14,
                        points: 2
                    },
                    {
                        image: "https://images.unsplash.com/photo-1542295669297-4d352b04b2d5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Anjali T.",
                        content: "Video review of this amazing outfit that fits my petite frame perfectly!",
                        likes: 124,
                        comments: 23,
                        points: 4
                    }
                ],
                discussions: [
                    {
                        user: "Neha K.",
                        time: "2 hours ago",
                        title: "Best jeans for petite body type?",
                        content: "I'm 5'1\" and struggling to find jeans that don't need hemming. Any recommendations for brands that offer petite sizes?",
                        replies: 24,
                        likes: 18
                    },
                    {
                        user: "Priya M.",
                        time: "5 hours ago",
                        title: "How to style oversized tops for petite frames?",
                        content: "I love the oversized trend but it often overwhelms my frame. Any styling tips for making oversized clothes work for petite women?",
                        replies: 32,
                        likes: 45
                    }
                ]
            },
            tall: {
                posts: [
                    {
                        image: "https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Aisha R.",
                        content: "Finally found jeans long enough for my 6' frame! These are perfect for tall women.",
                        likes: 78,
                        comments: 12,
                        points: 2
                    },
                    {
                        image: "https://images.unsplash.com/photo-1543163521-1bf539c55dd2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Sarah T.",
                        content: "This maxi dress is actually long enough for my height! No more short dresses!",
                        likes: 92,
                        comments: 15,
                        points: 2
                    }
                ],
                discussions: [
                    {
                        user: "Aisha R.",
                        time: "3 hours ago",
                        title: "Where to find extra-long sleeves?",
                        content: "As a tall woman, I always struggle with sleeves being too short. Any recommendations for brands with longer sleeve options?",
                        replies: 18,
                        likes: 27
                    },
                    {
                        user: "Michael K.",
                        time: "1 day ago",
                        title: "Tall men's fashion advice?",
                        content: "I'm 6'4\" and have trouble finding clothes that fit well. Any tips for tall men's fashion?",
                        replies: 22,
                        likes: 31
                    }
                ]
            },
            curvy: {
                posts: [
                    {
                        image: "https://images.unsplash.com/photo-1536678891919-e0e7d61a4b15?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Jessica L.",
                        content: "This dress hugs my curves in all the right places! Perfect for my body type.",
                        likes: 112,
                        comments: 24,
                        points: 2
                    },
                    {
                        image: "https://images.unsplash.com/photo-1567401893414-76b7b1e5a7a5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Maya P.",
                        content: "Finally found jeans that fit my curves without gaping at the waist!",
                        likes: 87,
                        comments: 19,
                        points: 2
                    }
                ],
                discussions: [
                    {
                        user: "Jessica L.",
                        time: "5 hours ago",
                        title: "Best brands for curvy women?",
                        content: "Looking for clothing brands that actually design for curvy bodies, not just larger sizes. Any recommendations?",
                        replies: 42,
                        likes: 56
                    },
                    {
                        user: "Sophia M.",
                        time: "2 days ago",
                        title: "How to style wrap dresses for curvy figures?",
                        content: "I love wrap dresses but struggle with finding ones that fit my bust properly. Any styling tips?",
                        replies: 31,
                        likes: 38
                    }
                ]
            },
            athletic: {
                posts: [
                    {
                        image: "https://images.unsplash.com/photo-1591047139829-d91aecb6caea?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Alex J.",
                        content: "These workout clothes are perfect for my athletic build - stretchy yet supportive!",
                        likes: 65,
                        comments: 14,
                        points: 2
                    },
                    {
                        image: "https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                        user: "Ryan T.",
                        content: "Finally found jeans that fit my athletic thighs without being too loose at the waist!",
                        likes: 78,
                        comments: 17,
                        points: 2
                    }
                ],
                discussions: [
                    {
                        user: "Alex J.",
                        time: "6 hours ago",
                        title: "Where to find clothes for broad shoulders?",
                        content: "As someone with an athletic build, I have broad shoulders that make many shirts fit poorly. Any recommendations?",
                        replies: 27,
                        likes: 33
                    },
                    {
                        user: "Taylor R.",
                        time: "1 day ago",
                        title: "Best athletic wear for weight training?",
                        content: "Looking for clothing that allows full range of motion during weight training sessions. Any favorites?",
                        replies: 35,
                        likes: 42
                    }
                ]
            }
        };
        
        // DOM Elements
        const createPostBtn = document.getElementById('createPostBtn');
        const createDiscussionBtn = document.getElementById('createDiscussionBtn');
        const createPostModal = document.getElementById('createPostModal');
        const createDiscussionModal = document.getElementById('createDiscussionModal');
        const closeModals = document.querySelectorAll('.close-modal');
        const mediaTypeBtns = document.querySelectorAll('.media-type-btn');
        const mediaUpload = document.getElementById('mediaUpload');
        const uploadArea = document.getElementById('uploadArea');
        const imagePreview = document.getElementById('imagePreview');
        const submitPostBtn = document.getElementById('submitPostBtn');
        const submitDiscussionBtn = document.getElementById('submitDiscussionBtn');
        const submitSpinner = document.getElementById('submitSpinner');
        const submitDiscussionSpinner = document.getElementById('submitDiscussionSpinner');
        const postsContainer = document.getElementById('postsContainer');
        const discussionsContainer = document.getElementById('discussionsContainer');
        const rewardAmount = document.getElementById('rewardAmount');
        const mediaTypeText = document.getElementById('mediaTypeText');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');
        const rewardPointsElements = document.querySelectorAll('#rewardPoints, #profileRewardPoints, #headerRewardPoints');
        const upvotesElement = document.getElementById('profileUpvotes');
        const postCountElement = document.getElementById('postCount'); // Added post count element
        const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
        const dropdownItems = document.querySelectorAll('.dropdown-item');
        const viewOptions = document.querySelectorAll('.view-option');
        const postsView = document.getElementById('postsView');
        const discussionsView = document.getElementById('discussionsView');
        const communityItems = document.querySelectorAll('.community-item');
        const sectionTitle = document.querySelector('.section-title');
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial content for the active community
            loadCommunityContent(currentCommunity, currentContentType);
            
            // Community selection
            communityItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    if (!e.target.closest('.community-dropdown')) {
                        communityItems.forEach(i => i.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Get the community type from data attribute
                        currentCommunity = this.getAttribute('data-community');
                        
                        // Update profile description
                        document.querySelector('.profile-details p').textContent = 
                            `Member of ${this.querySelector('.community-item-content span').textContent} community`;
                        
                        // Load content for the selected community
                        loadCommunityContent(currentCommunity, currentContentType);
                    }
                });
            });
            
            // Dropdown toggle functionality
            dropdownToggles.forEach(toggle => {
                toggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const dropdownMenu = this.nextElementSibling;
                    const isActive = dropdownMenu.classList.contains('active');
                    
                    // Close all dropdowns
                    document.querySelectorAll('.dropdown-menu').forEach(menu => {
                        menu.classList.remove('active');
                    });
                    
                    // Toggle this dropdown
                    if (!isActive) {
                        dropdownMenu.classList.add('active');
                    }
                });
            });
            
            // Dropdown item selection
            dropdownItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Remove active class from all items in this dropdown
                    const dropdownMenu = this.closest('.dropdown-menu');
                    dropdownMenu.querySelectorAll('.dropdown-item').forEach(i => {
                        i.classList.remove('active');
                    });
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Close the dropdown
                    dropdownMenu.classList.remove('active');
                    
                    // Update content type
                    const contentType = this.getAttribute('data-type');
                    currentContentType = contentType;
                    
                    // Load the appropriate content
                    loadCommunityContent(currentCommunity, contentType);
                });
            });
            
            // View toggle functionality
            viewOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const viewType = this.getAttribute('data-view');
                    changeView(viewType);
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function() {
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    menu.classList.remove('active');
                });
            });
            
            // Create post modal
            createPostBtn.addEventListener('click', function() {
                createPostModal.style.display = 'flex';
                resetForm();
            });
            
            // Create discussion modal
            createDiscussionBtn.addEventListener('click', function() {
                createDiscussionModal.style.display = 'flex';
            });
            
            // Close modals
            closeModals.forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });
            
            // Media type selection
            mediaTypeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    mediaTypeBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    mediaType = this.getAttribute('data-type');
                    rewardAmount.textContent = mediaType === 'photo' ? '2' : '4';
                    mediaTypeText.textContent = mediaType;
                    
                    // Update accepted file types
                    mediaUpload.setAttribute('accept', mediaType === 'photo' ? 'image/*' : 'video/*');
                    
                    // Reset upload area if media type changed
                    if (uploadedMedia && uploadedMedia.type !== mediaType) {
                        resetUploadArea();
                    }
                });
            });
            
            // File upload handling
            mediaUpload.addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const file = e.target.files[0];
                    const fileType = file.type.split('/')[0];
                    
                    // Validate file type
                    if ((mediaType === 'photo' && fileType !== 'image') || 
                        (mediaType === 'video' && fileType !== 'video')) {
                        alert(`Please select a ${mediaType} file`);
                        return;
                    }
                    
                    uploadedMedia = {
                        file: file,
                        type: mediaType,
                        url: URL.createObjectURL(file)
                    };
                    
                    // Update UI for image preview
                    if (mediaType === 'photo') {
                        imagePreview.innerHTML = `<img src="${uploadedMedia.url}" alt="Preview">`;
                        uploadArea.style.display = 'none';
                    } else {
                        // For videos, we'd handle differently
                        imagePreview.innerHTML = `
                            <video controls style="max-width: 100%">
                                <source src="${uploadedMedia.url}" type="${file.type}">
                                Your browser does not support the video tag.
                            </video>
                        `;
                        uploadArea.style.display = 'none';
                    }
                    
                    // Enable submit button
                    submitPostBtn.disabled = false;
                }
            });
            
            // Submit post
            submitPostBtn.addEventListener('click', function() {
                const caption = document.getElementById('postCaption').value.trim();
                
                if (!uploadedMedia) {
                    alert('Please upload a photo or video');
                    return;
                }
                
                if (!caption) {
                    alert('Please add a description');
                    return;
                }
                
                // Show loading state
                submitPostBtn.disabled = true;
                submitSpinner.style.display = 'inline-block';
                
                // Simulate upload delay
                setTimeout(() => {
                    // Create new post
                    createNewPost(caption, uploadedMedia);
                    
                    // Update reward points
                    const pointsEarned = mediaType === 'photo' ? 2 : 4;
                    rewardPoints += pointsEarned;
                    updateRewardPoints();
                    
                    // Update post count
                    postCount += 1;
                    updatePostCount();
                    
                    // Show notification
                    notificationText.textContent = `Post created successfully! +${pointsEarned} points earned.`;
                    notification.style.display = 'flex';
                    notification.style.background = '#4caf50';
                    
                    // Hide notification after 3 seconds
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 3000);
                    
                    // Close modal and reset form
                    createPostModal.style.display = 'none';
                    resetForm();
                    
                    // Hide loading state
                    submitSpinner.style.display = 'none';
                }, 1500);
            });
            
            // Submit discussion
            submitDiscussionBtn.addEventListener('click', function() {
                const title = document.getElementById('discussionTitle').value.trim();
                const content = document.getElementById('discussionContent').value.trim();
                
                if (!title) {
                    alert('Please add a discussion title');
                    return;
                }
                
                if (!content) {
                    alert('Please add discussion content');
                    return;
                }
                
                // Show loading state
                submitDiscussionBtn.disabled = true;
                submitDiscussionSpinner.style.display = 'inline-block';
                
                // Simulate creation delay
                setTimeout(() => {
                    // Create new discussion
                    createNewDiscussion(title, content);
                    
                    // Show notification
                    notificationText.textContent = `Discussion started successfully!`;
                    notification.style.display = 'flex';
                    notification.style.background = '#4caf50';
                    
                    // Hide notification after 3 seconds
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 3000);
                    
                    // Close modal and reset form
                    createDiscussionModal.style.display = 'none';
                    document.getElementById('discussionTitle').value = '';
                    document.getElementById('discussionContent').value = '';
                    
                    // Hide loading state
                    submitDiscussionBtn.disabled = false;
                    submitDiscussionSpinner.style.display = 'none';
                }, 1500);
            });
            
            // Like functionality
            document.addEventListener('click', function(e) {
                // Post like functionality
                if (e.target.closest('.post-action')) {
                    const action = e.target.closest('.post-action');
                    const icon = action.querySelector('i');
                    const count = action.querySelector('span');
                    const postCard = action.closest('.post-card');
                    const postId = postCard.id;
                    
                    if (icon.classList.contains('far')) {
                        icon.classList.remove('far');
                        icon.classList.add('fas');
                        icon.style.color = '#ff3f6c';
                        count.textContent = parseInt(count.textContent) + 1;
                        
                        // Increase upvotes count only if it's the user's own post
                        if (userPosts.has(postId)) {
                            upvotes += 1;
                            upvotesElement.textContent = upvotes;
                        }
                    } else {
                        icon.classList.remove('fas');
                        icon.classList.add('far');
                        icon.style.color = '';
                        count.textContent = parseInt(count.textContent) - 1;
                        
                        // Decrease upvotes count only if it's the user's own post
                        if (userPosts.has(postId)) {
                            upvotes -= 1;
                            upvotesElement.textContent = upvotes;
                        }
                    }
                }
                
                // Discussion like functionality
                if (e.target.closest('.discussion-stat:last-child')) {
                    const stat = e.target.closest('.discussion-stat');
                    const icon = stat.querySelector('i');
                    const count = stat.querySelector('span');
                    
                    if (icon.classList.contains('far')) {
                        icon.classList.remove('far');
                        icon.classList.add('fas');
                        icon.style.color = '#ff3f6c';
                        if (count) count.textContent = parseInt(count.textContent) + 1;
                    } else {
                        icon.classList.remove('fas');
                        icon.classList.add('far');
                        icon.style.color = '';
                        if (count) count.textContent = parseInt(count.textContent) - 1;
                    }
                }
            });
        });
        
        // Helper functions
        function resetForm() {
            resetUploadArea();
            document.getElementById('postCaption').value = '';
            mediaType = 'photo';
            mediaTypeBtns.forEach(btn => {
                if (btn.getAttribute('data-type') === 'photo') {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            rewardAmount.textContent = '2';
            mediaTypeText.textContent = 'photo';
            mediaUpload.setAttribute('accept', 'image/*');
            submitPostBtn.disabled = true;
        }
        
        function resetUploadArea() {
            uploadedMedia = null;
            uploadArea.style.display = 'flex';
            imagePreview.innerHTML = '';
            mediaUpload.value = '';
        }
        
        function createNewPost(caption, media) {
            const postId = 'post-' + Date.now();
            const pointsEarned = media.type === 'photo' ? 2 : 4;
            
            const postHtml = `
                <div class="post-card" id="${postId}">
                    <div class="post-image">
                        ${media.type === 'photo' ? 
                            `<img src="${media.url}" alt="User post">` : 
                            `<video controls><source src="${media.url}" type="${media.file.type}">Your browser does not support the video tag.</video>`
                        }
                    </div>
                    <div class="post-content">
                        <div class="user-info">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="user-name">You</div>
                        </div>
                        <p>${caption}</p>
                        <div class="post-stats">
                            <div class="post-actions">
                                <div class="post-action">
                                    <i class="far fa-heart"></i>
                                    <span>0</span>
                                </div>
                            </div>
                            <div class="rewards-badge">+${pointsEarned} Points</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Add new post at the beginning
            postsContainer.insertAdjacentHTML('afterbegin', postHtml);
            
            // Track this as the user's post
            userPosts.add(postId);
        }
        
        function createNewDiscussion(title, content) {
            const discussionId = Date.now();
            
            const discussionHtml = `
                <div class="discussion-card" id="discussion-${discussionId}">
                    <div class="discussion-header">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="discussion-user">You</div>
                        <div class="discussion-time">Just now</div>
                    </div>
                    <div class="discussion-title">${title}</div>
                    <div class="discussion-content">${content}</div>
                    <div class="discussion-stats">
                        <div class="discussion-stat">
                            0 replies
                        </div>
                        <div class="discussion-stat">
                            <i class="far fa-heart"></i> 0 likes
                        </div>
                    </div>
                </div>
            `;
            
            // Add new discussion at the beginning
            discussionsContainer.insertAdjacentHTML('afterbegin', discussionHtml);
        }
        
        function updateRewardPoints() {
            rewardPointsElements.forEach(el => {
                el.textContent = rewardPoints;
            });
        }
        
        function updatePostCount() {
            postCountElement.textContent = postCount;
        }
        
        function changeView(viewType) {
            currentView = viewType;
            
            // Update view toggle buttons
            viewOptions.forEach(option => {
                if (option.getAttribute('data-view') === viewType) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // Show/hide views
            if (viewType === 'posts') {
                postsView.style.display = 'block';
                discussionsView.style.display = 'none';
                sectionTitle.textContent = sectionTitle.textContent.replace('Discussions', 'Posts');
                    
                // Show create post button, hide create discussion button
                createPostBtn.style.display = 'flex';
                createDiscussionBtn.style.display = 'none';
                
                // Load posts content
                loadCommunityContent(currentCommunity, 'posts');
            } else {
                postsView.style.display = 'none';
                discussionsView.style.display = 'block';
                sectionTitle.textContent = sectionTitle.textContent.replace('Posts', 'Discussions');
                    
                // Show create discussion button, hide create post button
                createPostBtn.style.display = 'none';
                createDiscussionBtn.style.display = 'flex';
                
                // Load discussions content
                loadCommunityContent(currentCommunity, 'discussions');
            }
        }
        
        function loadCommunityContent(community, contentType) {
            const content = communityContent[community];
            const communityName = document.querySelector(`.community-item[data-community="${community}"] .community-item-content span`).textContent;
            
            // Update section title
            sectionTitle.textContent = `Recent ${contentType === 'posts' ? 'Posts' : 'Discussions'} in ${communityName}`;
            
            // Clear existing content
            postsContainer.innerHTML = '';
            discussionsContainer.innerHTML = '';
            
            // Load content based on type
            if (contentType === 'posts') {
                // Load posts
                if (content.posts && content.posts.length > 0) {
                    content.posts.forEach(post => {
                        const postHtml = `
                            <div class="post-card">
                                <div class="post-image">
                                    <img src="${post.image}" alt="Fashion post">
                                </div>
                                <div class="post-content">
                                    <div class="user-info">
                                        <div class="user-avatar">
                                            <i class="fas fa-user"></i>
                                        </div>
                                        <div class="user-name">${post.user}</div>
                                    </div>
                                    <p>${post.content}</p>
                                    <div class="post-stats">
                                        <div class="post-actions">
                                            <div class="post-action">
                                                <i class="far fa-heart"></i>
                                                <span>${post.likes}</span>
                                            </div>
                                        </div>
                                        <div class="rewards-badge">+${post.points} Points</div>
                                    </div>
                                </div>
                            </div>
                        `;
                        postsContainer.innerHTML += postHtml;
                    });
                } else {
                    postsContainer.innerHTML = '<p class="no-content">No posts yet in this community.</p>';
                }
            } else {
                // Load discussions
                if (content.discussions && content.discussions.length > 0) {
                    content.discussions.forEach(discussion => {
                        const discussionHtml = `
                            <div class="discussion-card">
                                <div class="discussion-header">
                                    <div class="user-avatar">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <div class="discussion-user">${discussion.user}</div>
                                    <div class="discussion-time">${discussion.time}</div>
                                </div>
                                <div class="discussion-title">${discussion.title}</div>
                                <div class="discussion-content">${discussion.content}</div>
                                <div class="discussion-stats">
                                    <div class="discussion-stat">
                                        ${discussion.replies} replies
                                    </div>
                                    <div class="discussion-stat">
                                        <i class="far fa-heart"></i> ${discussion.likes} likes
                                    </div>
                                </div>
                            </div>
                        `;
                        discussionsContainer.innerHTML += discussionHtml;
                    });
                } else {
                    discussionsContainer.innerHTML = '<p class="no-content">No discussions yet in this community.</p>';
                }
            }
        }
    </script>
</body>
</html>